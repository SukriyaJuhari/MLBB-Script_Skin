<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wait..Downloading</title>

  <script type="module">
    // ðŸ§  Daftar file download berdasarkan kode "file="

    import dataFileLinks from "./JS/dataFileLinks.js";
    
    const fileLink = new dataFileLinks();
    const fileLinks = fileLink.link;
    //console.log(fileLink);
    // Ambil parameter ?file= dari URL
    const urlParams = new URLSearchParams(window.location.search);
    const fileKey = urlParams.get('file');
    const targetURL = fileLinks[fileKey];
    
    const timer = document.getElementById("timer");
    const btn = document.getElementById("downloadBtn");
    
    // urutan click 
    let click_1 = true;
    
    
    if (targetURL) {
      
      document.querySelector(".fileName").innerHTML = `
    Menyiapkan file ${fileKey}.zip`;
      document.querySelector(".notif").innerHTML = `
      <p>Tunggu beberapa detik...<br>
        file hanya di halaman ini lainnya iklan! jika kamu dialihkan kembali ke halaman ini
      `;
      
      let seconds = 20;
      //let seconds = 1;//debugging
      let waitTime = 8; //time Tombo download 
      // let waitTime = 1; //debugging
      
      
      const countdown = setInterval(() => {
        seconds--;
        timer.textContent = seconds;
        
        if (seconds <= 0) {
          clearInterval(countdown);
          
          // Aktifkan tombol download
          btn.style.display = "inline-block";
          
          document.querySelector(".countdown").innerHTML = `
        Skroll ke bawah Klik tombol (Download Now)
      `;
          
          btn.innerHTML = `
        <b style="text-align:center;">
          <b style="color:#f1c40f;"></b> Download Now
        </b>`;
        }
        
      }, 1000);
      
      
      // Logika klik tombol
      btn.addEventListener("click", function(e) {
        e.preventDefault();
        
        if (click_1) {
          click_1 = false;
          
          const wait_2 = setInterval(() => {
            waitTime--;
            btn.textContent = `Wait... ${waitTime}`;
            
            if (waitTime <= 0) {
              clearInterval(wait_2);
              btn.textContent = "Download File";
            }
            
          }, 1000);
          
        } else {
          
          // Klik ketiga â†’ download file
          window.location.href = targetURL;
        }
        
      });
      
    } else {
      
      // Jika file tidak ditemukan
      document.querySelector(".notif").innerHTML = `
      <h3 style="color:#343435;">File Tidak Ditemukan ðŸ˜¢</h3>
    `;
    }
  </script>


  <style>
    :root {
      --bg: #ffffff;
      --accent: #6ee7b7;
      --accent-2: #60a5fa;
      --text: #022;
    }
    
    body {
      background: #ffff;
      color: #343435;
      font-family: "Poppins", sans-serif;
      text-align: center;
      align-items: center;
    }
    
    .container {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      max-width: 100%;
      min-height: 100vh;
      background: #fff;
      padding: 10px;
    }
    
    
    .cardfile {
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      text-align: center;
      max-width: 500px;
      margin: 10px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(0, 0, 0, 0.3);
      padding: 10px;
    }
    
    .fileName {
      color: #1D7DEE;
      font-size: 20px;
    }
    
    p {
      color: #343435;
    }
    
    .countdown {
      font-size: 20px;
      margin: 5px 0;
      color: #f1c40f;
      
    }
    
    .ads-area {
      background: #fff;
      border: 1px solid #f3f3f3;
      padding: 15px;
      margin: 20px 0;
      border-radius: 8px;
    }
    
    #cardBtn {
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
      max-width: 100%;
      margin: 10px;
    }
    
    .download-Btn {
      display: none;
      margin-top: 14px;
      background: linear-gradient(90deg, var(--accent), var(--accent-2));
      color: #022;
      font-size: 16px;
      padding: 10px;
      border-radius: 10px;
      text-decoration: none;
      font-weight: 800;
      box-shadow: 0 10px 22px rgba(00, 00, 00, 0.12);
    }
    
    .download-Btn:hover {
      transform: translateY(-2px);
    }
  </style>
</head>

<body>
  

  
  
  
  
  
  
  <div class="container">
    <div class="cardfile">
      <div class="fileName"></div>
      <div class="notif"></div>
      <div class="countdown" id="timer"></div>
    </div>
    
    
    
    
    
    
    

    
    
    <!-- Tombol manual jika redirect gagal -->
    <div id="cardBtn">
      <a style="display: none;" id="downloadBtn" href="#" class="download-Btn">Download Now</a>
    </div>
    

  
  

</body>

</html>